<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mic Probe - Diagnose Microphone Issues</title>
  <meta name="description" content="Test your microphone with real-world simulations. WebRTC, codec testing, and voice app profiles for Discord, Zoom, WhatsApp, and more.">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŽ¤</text></svg>">
  <!-- Google Fonts: Bricolage Grotesque (landing display) + Rubik (app display) + Inter (UI) + JetBrains Mono (monospace) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:wght@400;500;600;700&family=Rubik:wght@500;600;700;800&family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
  <!-- CSS -->
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/landing.css">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- SVG Gradient Definition (ayri, gorunur olmayan) -->
  <svg xmlns="http://www.w3.org/2000/svg" width="0" height="0" style="position:absolute">
    <defs>
      <!-- Brand icon gradient - sadece sol kisim (coral -> pink) - yazi ile birlesik gorunmesi icin -->
      <linearGradient id="brand-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stop-color="#e85d3b"/>
        <stop offset="100%" stop-color="#d946a8"/>
      </linearGradient>
    </defs>
  </svg>

  <!-- SVG Sprite (loaded from external file) -->
  <div id="svg-sprite-container"></div>
  <script>
    fetch('icons.svg')
      .then(r => r.text())
      .then(svg => document.getElementById('svg-sprite-container').innerHTML = svg);
  </script>

  <!-- ==================== LANDING VIEW ==================== -->
  <div id="landing-view">
    <!-- Navbar -->
    <nav class="navbar" id="navbar">
      <a href="#" class="navbar-brand">
        <svg class="navbar-logo" viewBox="0 0 24 24" fill="currentColor"><use href="#icon-mic-brand"/></svg>
        <span class="navbar-title brand-wordmark"><span class="brand-word brand-word--mic">Mic</span><span class="brand-word brand-word--probe">Probe</span></span>
      </a>
      <div class="navbar-nav">
        <a href="#features" class="navbar-link">Features</a>
        <a href="#how-it-works" class="navbar-link">How It Works</a>
        <button class="navbar-cta" onclick="showAppView()">Get Started</button>
      </div>
      <button class="navbar-menu-btn" id="mobileMenuBtn" aria-label="Menu">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
        </svg>
      </button>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
      <div class="hero-badge">
        <svg class="hero-badge-icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
        </svg>
        <span>Test Your Microphone Like a Pro</span>
      </div>

      <h1 class="hero-title">
        <span class="hero-title-line">Diagnose Microphone Issues</span>
        <span class="hero-title-line">With</span>
        <span class="hero-title-line gradient-text">Real-World Simulations</span>
      </h1>

      <p class="hero-subtitle">
        Simulate voice calls and recordings from Discord, Zoom, WhatsApp, and more.
        Test WebRTC codecs, analyze audio quality, and identify problems before they happen.
      </p>

      <div class="hero-buttons">
        <button class="btn btn--primary" onclick="showAppView()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M8 5v14l11-7z"/>
          </svg>
          Get Started
        </button>
        <a href="#features" class="btn btn--secondary">
          Learn More
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"/>
          </svg>
        </a>
      </div>

      <!-- Animated Microphone Visual -->
      <div class="hero-visual">
        <!-- Sound Wave Lines SVG - Harmonic sine ribbon (smooth, parallel, non-intersecting) -->
        <svg class="hero-soundwave" viewBox="0 0 1600 120" preserveAspectRatio="none" aria-hidden="true">
          <defs>
            <!-- Shared harmonic wave geometry (phase-aligned sine family + gentle center envelope) -->
            <path id="hero-wave-ribbon" d="M0.00,50.86 C3.33,50.77 13.33,50.49 20.00,50.30 C26.67,50.12 33.33,49.93 40.00,49.75 C46.67,49.56 53.33,49.38 60.00,49.20 C66.67,49.01 73.33,48.83 80.00,48.64 C86.67,48.46 93.33,48.27 100.00,48.09 C106.67,47.90 113.33,47.72 120.00,47.53 C126.67,47.35 133.33,47.17 140.00,46.99 C146.67,46.81 153.33,46.63 160.00,46.45 C166.67,46.28 173.33,46.10 180.00,45.94 C186.67,45.77 193.33,45.61 200.00,45.45 C206.67,45.30 213.33,45.15 220.00,45.02 C226.67,44.88 233.33,44.75 240.00,44.64 C246.67,44.52 253.33,44.42 260.00,44.33 C266.67,44.24 273.33,44.17 280.00,44.11 C286.67,44.06 293.33,44.02 300.00,44.00 C306.67,43.98 313.33,43.98 320.00,44.00 C326.67,44.02 333.33,44.07 340.00,44.13 C346.67,44.20 353.33,44.29 360.00,44.41 C366.67,44.53 373.33,44.67 380.00,44.83 C386.67,45.00 393.33,45.20 400.00,45.42 C406.67,45.64 413.33,45.88 420.00,46.15 C426.67,46.43 433.33,46.73 440.00,47.05 C446.67,47.37 453.33,47.72 460.00,48.09 C466.67,48.46 473.33,48.86 480.00,49.28 C486.67,49.69 493.33,50.13 500.00,50.58 C506.67,51.04 513.33,51.51 520.00,52.00 C526.67,52.49 533.33,52.99 540.00,53.50 C546.67,54.01 553.33,54.54 560.00,55.06 C566.67,55.59 573.33,56.12 580.00,56.65 C586.67,57.19 593.33,57.72 600.00,58.25 C606.67,58.78 613.33,59.31 620.00,59.82 C626.67,60.33 633.33,60.84 640.00,61.33 C646.67,61.82 653.33,62.29 660.00,62.75 C666.67,63.20 673.33,63.64 680.00,64.05 C686.67,64.45 693.33,64.84 700.00,65.20 C706.67,65.55 713.33,65.88 720.00,66.18 C726.67,66.47 733.33,66.73 740.00,66.96 C746.67,67.19 753.33,67.38 760.00,67.53 C766.67,67.69 773.33,67.80 780.00,67.88 C786.67,67.96 793.33,68.00 800.00,68.00 C806.67,68.00 813.33,67.96 820.00,67.88 C826.67,67.80 833.33,67.69 840.00,67.53 C846.67,67.38 853.33,67.19 860.00,66.96 C866.67,66.73 873.33,66.47 880.00,66.18 C886.67,65.88 893.33,65.55 900.00,65.20 C906.67,64.84 913.33,64.45 920.00,64.05 C926.67,63.64 933.33,63.20 940.00,62.75 C946.67,62.29 953.33,61.82 960.00,61.33 C966.67,60.84 973.33,60.33 980.00,59.82 C986.67,59.31 993.33,58.78 1000.00,58.25 C1006.67,57.72 1013.33,57.19 1020.00,56.65 C1026.67,56.12 1033.33,55.59 1040.00,55.06 C1046.67,54.54 1053.33,54.01 1060.00,53.50 C1066.67,52.99 1073.33,52.49 1080.00,52.00 C1086.67,51.51 1093.33,51.04 1100.00,50.58 C1106.67,50.13 1113.33,49.69 1120.00,49.28 C1126.67,48.86 1133.33,48.46 1140.00,48.09 C1146.67,47.72 1153.33,47.37 1160.00,47.05 C1166.67,46.73 1173.33,46.43 1180.00,46.15 C1186.67,45.88 1193.33,45.64 1200.00,45.42 C1206.67,45.20 1213.33,45.00 1220.00,44.83 C1226.67,44.67 1233.33,44.53 1240.00,44.41 C1246.67,44.29 1253.33,44.20 1260.00,44.13 C1266.67,44.07 1273.33,44.02 1280.00,44.00 C1286.67,43.98 1293.33,43.98 1300.00,44.00 C1306.67,44.02 1313.33,44.06 1320.00,44.11 C1326.67,44.17 1333.33,44.24 1340.00,44.33 C1346.67,44.42 1353.33,44.52 1360.00,44.64 C1366.67,44.75 1373.33,44.88 1380.00,45.02 C1386.67,45.15 1393.33,45.30 1400.00,45.45 C1406.67,45.61 1413.33,45.77 1420.00,45.94 C1426.67,46.10 1433.33,46.28 1440.00,46.45 C1446.67,46.63 1453.33,46.81 1460.00,46.99 C1466.67,47.17 1473.33,47.35 1480.00,47.53 C1486.67,47.72 1493.33,47.90 1500.00,48.09 C1506.67,48.27 1513.33,48.46 1520.00,48.64 C1526.67,48.83 1533.33,49.01 1540.00,49.20 C1546.67,49.38 1553.33,49.56 1560.00,49.75 C1566.67,49.93 1573.33,50.12 1580.00,50.30 C1586.67,50.49 1596.67,50.77 1600.00,50.86"/>

            <!-- Coordinated horizontal edge fade (shared for all waves) -->
            <linearGradient id="hero-wave-edge-fade" x1="0" y1="0" x2="1" y2="0">
              <stop offset="0%" stop-color="white" stop-opacity="0"/>
              <stop offset="14%" stop-color="white" stop-opacity="1"/>
              <stop offset="50%" stop-color="white" stop-opacity="1"/>
              <stop offset="86%" stop-color="white" stop-opacity="1"/>
              <stop offset="100%" stop-color="white" stop-opacity="0"/>
            </linearGradient>
            <mask id="hero-wave-mask">
              <rect x="0" y="0" width="1600" height="120" fill="url(#hero-wave-edge-fade)"/>
            </mask>

            <!-- Subtle glow (stronger on primary waves) -->
            <filter id="hero-wave-glow-soft" x="-20%" y="-60%" width="140%" height="220%" color-interpolation-filters="sRGB">
              <feGaussianBlur in="SourceGraphic" stdDeviation="2.2" result="blur"/>
              <feComponentTransfer in="blur" result="blurAlpha">
                <feFuncA type="linear" slope="0.45"/>
              </feComponentTransfer>
              <feMerge>
                <feMergeNode in="blurAlpha"/>
                <feMergeNode in="SourceGraphic"/>
              </feMerge>
            </filter>
            <filter id="hero-wave-glow-strong" x="-24%" y="-70%" width="148%" height="240%" color-interpolation-filters="sRGB">
              <feGaussianBlur in="SourceGraphic" stdDeviation="3.4" result="blur"/>
              <feComponentTransfer in="blur" result="blurAlpha">
                <feFuncA type="linear" slope="0.60"/>
              </feComponentTransfer>
              <feMerge>
                <feMergeNode in="blurAlpha"/>
                <feMergeNode in="SourceGraphic"/>
              </feMerge>
            </filter>

            <!-- Rainbow ribbon gradients (warm -> magenta/purple -> cool), slightly varied per wave -->
            <linearGradient id="hero-wave-grad-1" gradientUnits="userSpaceOnUse" x1="0" y1="0" x2="1600" y2="0">
              <stop offset="0%" stop-color="#f59e0b"/>
              <stop offset="22%" stop-color="#fb7185"/>
              <stop offset="48%" stop-color="#c026d3"/>
              <stop offset="62%" stop-color="#7c3aed"/>
              <stop offset="82%" stop-color="#2563eb"/>
              <stop offset="100%" stop-color="#60a5fa"/>
            </linearGradient>
            <linearGradient id="hero-wave-grad-2" gradientUnits="userSpaceOnUse" x1="0" y1="0" x2="1600" y2="0">
              <stop offset="0%" stop-color="#fb923c"/>
              <stop offset="22%" stop-color="#f472b6"/>
              <stop offset="48%" stop-color="#d946ef"/>
              <stop offset="62%" stop-color="#8b5cf6"/>
              <stop offset="82%" stop-color="#3b82f6"/>
              <stop offset="100%" stop-color="#60a5fa"/>
            </linearGradient>
            <linearGradient id="hero-wave-grad-3" gradientUnits="userSpaceOnUse" x1="0" y1="0" x2="1600" y2="0">
              <stop offset="0%" stop-color="#fbbf24"/>
              <stop offset="22%" stop-color="#fb7185"/>
              <stop offset="48%" stop-color="#d946ef"/>
              <stop offset="62%" stop-color="#8b5cf6"/>
              <stop offset="82%" stop-color="#2563eb"/>
              <stop offset="100%" stop-color="#60a5fa"/>
            </linearGradient>
            <linearGradient id="hero-wave-grad-4" gradientUnits="userSpaceOnUse" x1="0" y1="0" x2="1600" y2="0">
              <stop offset="0%" stop-color="#f59e0b"/>
              <stop offset="22%" stop-color="#fb7185"/>
              <stop offset="48%" stop-color="#e879f9"/>
              <stop offset="62%" stop-color="#a78bfa"/>
              <stop offset="82%" stop-color="#3b82f6"/>
              <stop offset="100%" stop-color="#93c5fd"/>
            </linearGradient>
            <linearGradient id="hero-wave-grad-5" gradientUnits="userSpaceOnUse" x1="0" y1="0" x2="1600" y2="0">
              <stop offset="0%" stop-color="#fb923c"/>
              <stop offset="22%" stop-color="#f472b6"/>
              <stop offset="48%" stop-color="#c026d3"/>
              <stop offset="62%" stop-color="#7c3aed"/>
              <stop offset="82%" stop-color="#1d4ed8"/>
              <stop offset="100%" stop-color="#60a5fa"/>
            </linearGradient>
            <linearGradient id="hero-wave-grad-6" gradientUnits="userSpaceOnUse" x1="0" y1="0" x2="1600" y2="0">
              <stop offset="0%" stop-color="#fbbf24"/>
              <stop offset="22%" stop-color="#fb7185"/>
              <stop offset="48%" stop-color="#d946ef"/>
              <stop offset="62%" stop-color="#8b5cf6"/>
              <stop offset="82%" stop-color="#3b82f6"/>
              <stop offset="100%" stop-color="#60a5fa"/>
            </linearGradient>
          </defs>

          <g mask="url(#hero-wave-mask)" fill="none">
            <use href="#hero-wave-ribbon" class="wave-line wave-1" transform="translate(0 -20)" stroke="url(#hero-wave-grad-1)" stroke-width="1.25" opacity="0.18" filter="url(#hero-wave-glow-soft)"/>
            <use href="#hero-wave-ribbon" class="wave-line wave-2" transform="translate(0 -12)" stroke="url(#hero-wave-grad-2)" stroke-width="1.5" opacity="0.28" filter="url(#hero-wave-glow-soft)"/>
            <use href="#hero-wave-ribbon" class="wave-line wave-3" transform="translate(0 -4)" stroke="url(#hero-wave-grad-3)" stroke-width="2" opacity="0.58" filter="url(#hero-wave-glow-strong)"/>
            <use href="#hero-wave-ribbon" class="wave-line wave-4" transform="translate(0 4)" stroke="url(#hero-wave-grad-4)" stroke-width="2.25" opacity="0.72" filter="url(#hero-wave-glow-strong)"/>
            <use href="#hero-wave-ribbon" class="wave-line wave-5" transform="translate(0 12)" stroke="url(#hero-wave-grad-5)" stroke-width="1.5" opacity="0.28" filter="url(#hero-wave-glow-soft)"/>
            <use href="#hero-wave-ribbon" class="wave-line wave-6" transform="translate(0 20)" stroke="url(#hero-wave-grad-6)" stroke-width="1.25" opacity="0.18" filter="url(#hero-wave-glow-soft)"/>
          </g>
        </svg>
        <!-- Circular Ripples -->
        <div class="hero-waves">
          <div class="hero-wave"></div>
          <div class="hero-wave"></div>
          <div class="hero-wave"></div>
        </div>
        <div class="hero-mic-icon" onclick="showAppView()" title="Get Started"
             onmouseenter="document.querySelector('.hero-buttons .btn--primary').classList.add('mic-hover-active')"
             onmouseleave="document.querySelector('.hero-buttons .btn--primary').classList.remove('mic-hover-active')">
          <div class="hero-mic-circle">
            <svg viewBox="0 0 24 24" fill="currentColor"><use href="#icon-mic"/></svg>
          </div>
        </div>
      </div>
    </section>

    <!-- Features Section -->
    <section class="features" id="features">
      <div class="section-header">
        <span class="section-badge">Features</span>
        <h2 class="section-title">Everything You Need to Test Your Mic</h2>
        <p class="section-subtitle">Professional-grade tools to diagnose and analyze microphone issues across different platforms.</p>
      </div>

      <div class="features-grid">
        <!-- Feature 1: Voice Call Simulation -->
        <div class="feature-card">
          <div class="feature-icon">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M20 15.5c-1.25 0-2.45-.2-3.57-.57a1.02 1.02 0 00-1.02.24l-2.2 2.2a15.074 15.074 0 01-6.59-6.58l2.2-2.21c.28-.27.36-.66.25-1.01A11.36 11.36 0 018.5 4c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.5c0-.55-.45-1-1-1z"/>
            </svg>
          </div>
          <h3 class="feature-title">Voice Call Simulation</h3>
          <p class="feature-description">
            Test your mic with real WebRTC loopback. Simulate Discord, Zoom, Google Meet, and Teams with authentic Opus codec settings.
          </p>
        </div>

        <!-- Feature 2: Voice Message Testing -->
        <div class="feature-card">
          <div class="feature-icon">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1 1.93c-3.94-.49-7-3.85-7-7.93h2c0 3.31 2.69 6 6 6s6-2.69 6-6h2c0 4.08-3.06 7.44-7 7.93V20h4v2H8v-2h4v-4.07z"/>
            </svg>
          </div>
          <h3 class="feature-title">Voice Message Testing</h3>
          <p class="feature-description">
            Record and playback with MediaRecorder. Test WhatsApp and Telegram voice message quality with configurable bitrates.
          </p>
        </div>

        <!-- Feature 3: Real-Time Monitoring -->
        <div class="feature-card">
          <div class="feature-icon">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/>
            </svg>
          </div>
          <h3 class="feature-title">Real-Time Monitoring</h3>
          <p class="feature-description">
            Live VU meters show input levels instantly. Dual meters for local and remote (codec-processed) audio comparison.
          </p>
        </div>

        <!-- Feature 4: Profile-Based Testing -->
        <div class="feature-card">
          <div class="feature-icon">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58a.49.49 0 00.12-.61l-1.92-3.32a.488.488 0 00-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 00-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58a.49.49 0 00-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
            </svg>
          </div>
          <h3 class="feature-title">Profile-Based Testing</h3>
          <p class="feature-description">
            Pre-configured profiles for popular apps. One click to match Discord, Zoom, WhatsApp, or Telegram audio settings.
          </p>
        </div>
      </div>
    </section>

    <!-- How It Works Section -->
    <section class="how-it-works" id="how-it-works">
      <div class="section-header">
        <span class="section-badge">How It Works</span>
        <h2 class="section-title">Three Simple Steps</h2>
        <p class="section-subtitle">Get started in seconds with our intuitive testing workflow.</p>
      </div>

      <div class="steps-container">
        <div class="step-card">
          <div class="step-number">1</div>
          <h3 class="step-title">Select a Profile</h3>
          <p class="step-description">
            Choose from Voice Calls (Discord, Zoom) or Voice Messages (WhatsApp, Telegram). Each profile mimics real app settings.
          </p>
        </div>

        <div class="step-card">
          <div class="step-number">2</div>
          <h3 class="step-title">Test Your Mic</h3>
          <p class="step-description">
            Use Monitor mode to hear yourself through the codec, or Record mode to capture and analyze your audio quality.
          </p>
        </div>

        <div class="step-card">
          <div class="step-number">3</div>
          <h3 class="step-title">Analyze Results</h3>
          <p class="step-description">
            Review VU meters, playback recordings, and check the console for detailed codec and audio processing information.
          </p>
        </div>
      </div>
    </section>

  </div>

  <!-- ==================== APP VIEW ==================== -->
  <div id="app-view" class="hidden">
    <div class="app-shell">
      <header class="app-header">
        <div class="app-header-content">
          <a href="#" class="brand-mark" onclick="showLandingView(); return false;" title="Back to Home">
            <svg class="brand-logo" viewBox="0 0 24 24" fill="currentColor"><use href="#icon-mic-brand"/></svg>
            <span class="brand-title brand-wordmark"><span class="brand-word brand-word--mic">Mic</span><span class="brand-word brand-word--probe">Probe</span></span>
          </a>
        </div>
      </header>

      <div class="app-layout">
      <!-- Sidebar -->
      <aside class="sidebar">
        <nav class="sidebar-nav">
          <!-- Voice Calls Category -->
          <div class="nav-section">
            <span class="nav-section-title">Voice Calls</span>
            <button class="nav-item nav-item-sub active" data-profile="discord">
              <svg><use href="#icon-discord"/></svg>
              <span>Discord</span>
            </button>
            <button class="nav-item nav-item-sub" data-profile="zoom">
              <svg><use href="#icon-zoom"/></svg>
              <span>Zoom / Meet / Teams</span>
            </button>
            <button class="nav-item nav-item-sub" data-profile="whatsapp-call">
              <svg><use href="#icon-whatsapp"/></svg>
              <span>WhatsApp Call</span>
            </button>
            <button class="nav-item nav-item-sub" data-profile="telegram-call">
              <svg><use href="#icon-telegram"/></svg>
              <span>Telegram Call</span>
            </button>
          </div>

          <!-- Voice Messages Category -->
          <div class="nav-section">
            <span class="nav-section-title">Voice Messages</span>
            <button class="nav-item nav-item-sub" data-profile="whatsapp-voice">
              <svg><use href="#icon-whatsapp"/></svg>
              <span>WhatsApp Voice</span>
            </button>
            <button class="nav-item nav-item-sub" data-profile="telegram-voice">
              <svg><use href="#icon-telegram"/></svg>
              <span>Telegram Voice</span>
            </button>
            <button class="nav-item nav-item-sub" data-profile="legacy">
              <svg><use href="#icon-legacy"/></svg>
              <span>Legacy Web</span>
            </button>
            <button class="nav-item nav-item-sub" data-profile="raw">
              <svg><use href="#icon-mic"/></svg>
              <span>Raw Recording</span>
            </button>
          </div>
        </nav>

      </aside>

      <!-- Main Content -->
      <main class="main-content">
        <div class="content-container">
          <!-- Header -->
          <header class="page-header">
            <div class="header-left">
              <div class="header-title-row">
                <svg id="pageTitleIcon" class="page-title-icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                  <use href="#icon-discord"/>
                </svg>
                <h1 id="pageTitle">Discord Voice Test</h1>
                <span id="statusBadge" class="status status-idle"><span class="status-dot"></span>Ready</span>
              </div>
              <p id="pageSubtitle">WebRTC Loopback + Opus 64kbps</p>
            </div>
          </header>

          <!-- Two Column Layout: Main + Info Sidebar -->
          <!-- Single Unified Panel -->
          <div class="panel panel-unified">
            <div class="panel-body unified-body">
              <!-- Row 1: Controls + Tips + Audio Status -->
              <div class="unified-row unified-row-main">
                <!-- Controls Section -->
                <div class="unified-section unified-controls">
                  <div class="mic-selector-row">
                    <select id="micSelector" class="mic-dropdown">
                      <option value="">Default microphone</option>
                    </select>
                    <button id="refreshMics" class="btn-icon" title="Refresh microphone list">
                      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg>
                    </button>
                  </div>

                  <div class="button-row">
                    <button id="recordToggle" class="btn btn-action btn-record">
                      <svg class="icon-circle" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><circle cx="12" cy="12" r="8"/></svg>
                      <svg class="icon-square" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="6" width="12" height="12" rx="2"/></svg>
                      <span class="btn-text">Record</span>
                    </button>
                    <button id="monitorToggle" class="btn btn-action btn-monitor">
                      <svg class="icon-play" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"/></svg>
                      <svg class="icon-stop" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="6" width="12" height="12" rx="2"/></svg>
                      <span class="btn-text">Monitor</span>
                    </button>
                  </div>

                  <div id="recordingTimer" class="recording-timer">0:00</div>
                  <div id="preparingOverlay" class="preparing-overlay">
                    <span class="preparing-spinner"></span>
                    <span class="preparing-text">Preparing...</span>
                  </div>
                </div>

                <!-- Tips (inline text, no boxes) -->
                <div class="unified-tips">
                  <span class="utip"><em>1</em><span class="utip-text">Click <strong>Monitor</strong> to hear yourself</span></span>
                  <span class="utip"><em>2</em><span class="utip-text">Watch the VU meters for levels</span></span>
                  <span class="utip"><em>3</em><span class="utip-text">Use <strong>Record</strong> to capture</span></span>
                </div>

                <!-- Audio Status -->
                <div id="deviceInfoPanel" class="unified-status">
                  <div class="stat"><span class="stat-l">Mic</span><span id="infoMicName" class="stat-v">--</span></div>
                  <div class="stat"><span class="stat-l">Ch</span><span id="infoChannels" class="stat-v">--</span></div>
                  <div class="stat"><span class="stat-l">Target</span><span id="infoTargetBitrate" class="stat-v">--</span></div>
                  <div class="stat"><span class="stat-l">Actual</span><span id="infoActualBitrate" class="stat-v">--</span></div>
                </div>
              </div>

              <!-- Row 2: VU Meters -->
              <div class="unified-row unified-row-vu">
                <div class="vu-section">
                  <div class="vu-label">
                    <span id="signalDot" class="signal-dot"></span>
                    <span>Local (Microphone)</span>
                  </div>
                  <div class="vu-meter">
                    <div id="vuMeterBar" class="vu-meter-bar"></div>
                    <div id="vuMeterPeak" class="vu-meter-peak"></div>
                  </div>
                </div>
                <div id="remoteVuContainer" class="vu-section">
                  <div class="vu-label">
                    <span class="signal-dot remote-dot"></span>
                    <span>Remote (After Codec)</span>
                  </div>
                  <div class="vu-meter">
                    <div id="remoteVuBar" class="vu-meter-bar remote-bar"></div>
                    <div id="remoteVuPeak" class="vu-meter-peak"></div>
                  </div>
                </div>
              </div>

              <!-- Row 3: Player -->
              <div class="unified-row unified-row-player">
                <div id="recordingPlayer" class="recording-player">
                  <div class="player-controls">
                    <button id="playBtn" class="btn-play">
                      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>
                    </button>
                    <div class="player-info">
                      <div id="playerFilename" class="player-filename">No recording</div>
                      <div id="playerMeta" class="player-meta">-</div>
                    </div>
                  </div>
                  <div class="player-progress-row">
                    <div class="progress-bar" id="progressBar">
                      <div id="progressFill" class="progress-fill"></div>
                    </div>
                    <div id="playerTime" class="player-time">0:00 / 0:00</div>
                  </div>
                  <div class="player-actions">
                    <a id="downloadBtn" class="btn-download" href="#" download>
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
                      Download
                    </a>
                  </div>
                </div>
                <p id="noRecording" class="empty-state" style="display: none;">No recording yet</p>
              </div>

              <!-- Row 4: Custom Settings (Collapsible) -->
              <div class="unified-row unified-row-settings" id="customSettingsPanel">
                <div class="custom-settings-toggle" id="customSettingsToggle">
                  <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
                  <span>Custom Settings</span>
                  <svg class="toggle-chevron" viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M7 10l5 5 5-5z"/></svg>
                </div>
                <div class="custom-settings-content collapsed" id="customSettingsContent">
                  <div class="custom-settings-grid" id="customSettingsGrid">
                    <!-- Dynamic content via JS -->
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>

      </main>
    </div>


      <!-- Dev Console Slide Panel (from right) -->
      <div class="dev-console-drawer" id="devConsole">
        <div class="dev-console-drawer-header">
          <div class="drawer-title">
            <svg class="toggle-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-5 14H4v-4h11v4zm0-5H4V9h11v4zm5 5h-4V9h4v9z"/></svg>
            <span>Console</span>
            <span class="log-count" id="logCount">0</span>
          </div>
          <div class="header-actions">
            <button class="btn-copy" id="copyLogsBtn" onclick="copyAllLogs()" title="Copy all logs">
              <svg class="icon-copy" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
              <svg class="icon-check" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
            </button>
            <button class="btn-clear" onclick="clearLog()">Clear</button>
            <button class="btn-close-console" onclick="toggleDevConsole()" title="Close Console">
              <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
            </button>
          </div>
        </div>
        <div class="dev-console-drawer-body">
          <pre id="log"></pre>
        </div>
        <div class="dev-console-drawer-footer">
          <div class="filter-buttons">
            <button class="btn-filter active" data-category="all" onclick="filterLogs('all')">All</button>
            <button class="btn-filter btn-filter-error" data-category="error" onclick="filterLogs('error')">Errors</button>
            <button class="btn-filter" data-category="webaudio" onclick="filterLogs('webaudio')">WebAudio</button>
            <button class="btn-filter" data-category="stream" onclick="filterLogs('stream')">Stream</button>
            <button class="btn-filter" data-category="recorder" onclick="filterLogs('recorder')">Recorder</button>
          </div>
          <div class="export-buttons">
            <button class="btn-export-small" onclick="exportLogs()" title="Export logs as JSON">Export</button>
            <button class="btn-export-small" onclick="getLogStats()" title="Log statistics">Stats</button>
            <button class="btn-export-small" onclick="runSanityChecks()" title="Log sanity check">Sanity</button>
          </div>
        </div>
      </div>

      <!-- Console Toggle Button (Fixed at right edge) -->
      <button class="dev-console-toggle-btn" id="devConsoleToggle" onclick="toggleDevConsole()" title="Toggle Developer Console">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-5 14H4v-4h11v4zm0-5H4V9h11v4zm5 5h-4V9h4v9z"/></svg>
      </button>

      <!-- Settings Drawer -->
      <div id="settingsDrawer" class="settings-drawer">
        <div class="drawer-header">
          <h3>Advanced Settings</h3>
          <button class="btn-close-drawer" id="closeDrawer">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
          </button>
        </div>
        <div class="drawer-body">
          <!-- Audio Processing -->
          <div class="settings-section">
            <div class="settings-section-title">Audio Processing</div>
            <div class="settings-grid">
              <label class="setting-item">
                <input id="ec" type="checkbox" checked>
                <span class="setting-label">Echo Cancellation</span>
              </label>
              <label class="setting-item">
                <input id="ns" type="checkbox" checked>
                <span class="setting-label">Noise Suppression</span>
              </label>
              <label class="setting-item">
                <input id="agc" type="checkbox" checked>
                <span class="setting-label">Auto Gain Control</span>
              </label>
            </div>

            <!-- Sample Rate -->
            <div id="sampleRateContainer" class="mode-container" data-setting="sampleRate">
              <div class="mode-label">
                <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>
                <span>Sample Rate</span>
              </div>
              <div class="segment-control" id="sampleRateSelector">
                <input type="radio" name="sampleRate" id="sr16" value="16000">
                <label for="sr16" class="segment-btn">16 kHz</label>
                <input type="radio" name="sampleRate" id="sr22" value="22050">
                <label for="sr22" class="segment-btn">22 kHz</label>
                <input type="radio" name="sampleRate" id="sr44" value="44100">
                <label for="sr44" class="segment-btn">44.1 kHz</label>
                <input type="radio" name="sampleRate" id="sr48" value="48000" checked>
                <label for="sr48" class="segment-btn">48 kHz</label>
              </div>
            </div>

            <!-- Channel Count -->
            <div id="channelCountContainer" class="mode-container" data-setting="channelCount">
              <div class="mode-label">
                <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.76 16.24l-1.41 1.41C4.78 16.1 4 14.05 4 12c0-2.05.78-4.1 2.34-5.66l1.41 1.41C6.59 8.93 6 10.46 6 12s.59 3.07 1.76 4.24zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm5.66 1.66l-1.41-1.41C17.41 15.07 18 13.54 18 12s-.59-3.07-1.76-4.24l1.41-1.41C19.22 7.9 20 9.95 20 12c0 2.05-.78 4.1-2.34 5.66z"/></svg>
                <span>Channel Count</span>
              </div>
              <div class="segment-control" id="channelCountSelector">
                <input type="radio" name="channelCount" id="ch1" value="1" checked>
                <label for="ch1" class="segment-btn">Mono</label>
                <input type="radio" name="channelCount" id="ch2" value="2">
                <label for="ch2" class="segment-btn">Stereo</label>
              </div>
            </div>
          </div>

          <!-- Pipeline Settings -->
          <div class="settings-section" id="pipelineSection">
            <div class="settings-section-title">Pipeline</div>

            <!-- Pipeline Selector -->
            <div id="pipelineContainer" class="mode-container" data-setting="pipeline">
              <div class="mode-label">
                <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/></svg>
                <span>Pipeline</span>
              </div>
              <div class="segment-control" id="pipelineSelector">
                <input type="radio" name="pipeline" id="pipelineDirect" value="direct">
                <label for="pipelineDirect" class="segment-btn">Direct</label>
                <input type="radio" name="pipeline" id="pipelineStandard" value="standard" checked>
                <label for="pipelineStandard" class="segment-btn">Standard</label>
                <input type="radio" name="pipeline" id="pipelineScript" value="scriptprocessor">
                <label for="pipelineScript" class="segment-btn">ScriptProcessor</label>
                <input type="radio" name="pipeline" id="pipelineWorklet" value="worklet">
                <label for="pipelineWorklet" class="segment-btn">Worklet</label>
              </div>
            </div>

            <!-- Encoder Selector -->
            <div id="encoderContainer" class="mode-container" data-setting="encoder">
              <div class="mode-label">
                <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/></svg>
                <span>Encoder</span>
              </div>
              <div class="segment-control" id="encoderSelector">
                <input type="radio" name="encoder" id="encoderMediaRecorder" value="mediarecorder" checked>
                <label for="encoderMediaRecorder" class="segment-btn">MediaRecorder</label>
                <input type="radio" name="encoder" id="encoderWasmOpus" value="wasm-opus" data-requires-wasm="true">
                <label for="encoderWasmOpus" class="segment-btn">WASM Opus</label>
              </div>
            </div>

            <!-- Buffer Size -->
            <div id="bufferSizeContainer" class="mode-container" data-setting="buffer">
              <div class="mode-label">
                <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M4 6h18V4H4c-1.1 0-2 .9-2 2v11H0v3h14v-3H4V6zm19 2h-6c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1zm-1 9h-4v-7h4v7z"/></svg>
                <span>Buffer Size</span>
              </div>
              <div class="segment-control" id="bufferSizeSelector">
                <input type="radio" name="bufferSize" id="buffer1024" value="1024">
                <label for="buffer1024" class="segment-btn">1024</label>
                <input type="radio" name="bufferSize" id="buffer2048" value="2048">
                <label for="buffer2048" class="segment-btn">2048</label>
                <input type="radio" name="bufferSize" id="buffer4096" value="4096" checked>
                <label for="buffer4096" class="segment-btn">4096</label>
              </div>
              <div class="buffer-info">
                <span class="info-text" id="bufferInfoText">4096 samples @ 48kHz = ~85ms latency</span>
              </div>
            </div>
          </div>

          <!-- WebRTC Settings -->
          <div class="settings-section" id="webrtcSection">
            <div class="settings-section-title">WebRTC Simulation</div>

            <div class="loopback-toggle-container" data-setting="loopback">
              <div class="toggle-info">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.94-.49-7-3.85-7-7.93s3.05-7.44 7-7.93v15.86zm2-15.86c1.03.13 2 .45 2.87.93H13v-.93zM13 7h5.24c.25.31.48.65.68 1H13V7zm0 3h6.74c.08.33.15.66.19 1H13v-1zm0 9.93V19h2.87c-.87.48-1.84.8-2.87.93zM18.24 17H13v-1h5.92c-.2.35-.43.69-.68 1zm1.5-3H13v-1h6.93c-.04.34-.11.67-.19 1z"/></svg>
                <div>
                  <span class="toggle-title">WebRTC Loopback</span>
                  <span class="toggle-desc">Live call codec simulation</span>
                </div>
              </div>
              <label class="toggle-switch loopback-switch">
                <input type="checkbox" id="loopbackToggle">
                <span class="toggle-slider"></span>
              </label>
            </div>

            <div id="opusBitrateContainer" class="mode-container" data-setting="bitrate">
              <div class="mode-label">
                <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/></svg>
                <span>Opus Bitrate (WebRTC)</span>
              </div>
              <div class="segment-control" id="bitrateSelector">
                <input type="radio" name="bitrate" id="bitrate32" value="32000">
                <label for="bitrate32" class="segment-btn">32 kbps</label>
                <input type="radio" name="bitrate" id="bitrate48" value="48000">
                <label for="bitrate48" class="segment-btn">48 kbps</label>
                <input type="radio" name="bitrate" id="bitrate64" value="64000" checked>
                <label for="bitrate64" class="segment-btn">64 kbps</label>
                <input type="radio" name="bitrate" id="bitrate96" value="96000">
                <label for="bitrate96" class="segment-btn">96 kbps</label>
                <input type="radio" name="bitrate" id="bitrate128" value="128000">
                <label for="bitrate128" class="segment-btn">128 kbps</label>
              </div>
            </div>

            <div id="mediaBitrateContainer" class="mode-container" data-setting="mediaBitrate">
              <div class="mode-label">
                <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/></svg>
                <span>Voice Message Bitrate</span>
              </div>
              <div class="segment-control" id="mediaBitrateSelector">
                <input type="radio" name="mediaBitrate" id="mediaBitrate0" value="0" checked>
                <label for="mediaBitrate0" class="segment-btn">Auto</label>
                <input type="radio" name="mediaBitrate" id="mediaBitrate16" value="16000">
                <label for="mediaBitrate16" class="segment-btn">16 kbps</label>
                <input type="radio" name="mediaBitrate" id="mediaBitrate24" value="24000">
                <label for="mediaBitrate24" class="segment-btn">24 kbps</label>
                <input type="radio" name="mediaBitrate" id="mediaBitrate32" value="32000">
                <label for="mediaBitrate32" class="segment-btn">32 kbps</label>
              </div>
            </div>
          </div>

          <!-- Developer Settings -->
          <div class="settings-section" id="developerSection">
            <div class="settings-section-title">Developer</div>

            <div class="mode-container" data-setting="timeslice">
              <div class="mode-label">
                <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/></svg>
                <span>Timeslice Test</span>
              </div>
              <div class="segment-control timeslice-selector" id="timesliceSelector">
                <input type="radio" name="timeslice" id="tsOff" value="0" checked>
                <label for="tsOff" class="segment-btn">OFF</label>
                <input type="radio" name="timeslice" id="ts100" value="100">
                <label for="ts100" class="segment-btn">100ms</label>
                <input type="radio" name="timeslice" id="ts250" value="250">
                <label for="ts250" class="segment-btn">250ms</label>
                <input type="radio" name="timeslice" id="ts500" value="500">
                <label for="ts500" class="segment-btn">500ms</label>
                <input type="radio" name="timeslice" id="ts1000" value="1000">
                <label for="ts1000" class="segment-btn">1s</label>
              </div>
              <div class="timeslice-info" id="timesliceInfo">
                <span class="info-text">OFF: Single chunk - no timeslice</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id="drawerOverlay" class="drawer-overlay"></div>

      <!-- Hidden profile selector for compatibility -->
      <select id="profileSelector" class="profile-dropdown" style="display: none;">
        <option value="discord" selected>Discord Voice</option>
        <option value="zoom">Zoom / Meet</option>
        <option value="whatsapp-call">WhatsApp Call</option>
        <option value="telegram-call">Telegram Call</option>
        <option value="whatsapp-voice">WhatsApp Voice</option>
        <option value="telegram-voice">Telegram Voice</option>
        <option value="legacy">Legacy Web</option>
        <option value="raw">Raw Recording</option>
      </select>

      <div id="scenarioCards" style="display: none;"></div>
      <div id="activeScenarioInfo" style="display: none;">
        <span id="scenarioBadge">Discord Voice</span>
        <span id="scenarioTech">WebRTC Loopback + Opus 64kbps</span>
      </div>
    </div>
  </div>

  <!-- ==================== SHARED FOOTER ==================== -->
  <footer class="site-footer" id="sharedFooter">
    <div class="site-footer-content">
      <a href="#" class="site-footer-brand" onclick="showLandingView(); return false;">
        <svg viewBox="0 0 24 24" fill="currentColor"><use href="#icon-mic-brand"/></svg>
        <span class="brand-wordmark"><span class="brand-word brand-word--mic">Mic</span><span class="brand-word brand-word--probe">Probe</span></span>
      </a>
      <nav class="site-footer-links">
        <a href="#features" onclick="showLandingView();">Features</a>
        <a href="#how-it-works" onclick="showLandingView();">How It Works</a>
      </nav>
      <p class="site-footer-meta">Built for developers and audio enthusiasts</p>
    </div>
  </footer>

  <!-- View Manager Script -->
  <script>
    // View switching with hash routing
    function showAppView() {
      document.body.classList.add('app-mode');
      document.getElementById('landing-view').classList.add('hidden');
      document.getElementById('app-view').classList.remove('hidden');
      window.scrollTo(0, 0);

      // Update URL hash
      if (window.location.hash !== '#app') {
        history.pushState(null, '', '#app');
      }

      // Initialize app if not already done
      if (window.initializeApp && !window.appInitialized) {
        window.initializeApp();
        window.appInitialized = true;
      }
    }

    function showLandingView() {
      document.body.classList.remove('app-mode');
      document.getElementById('app-view').classList.add('hidden');
      document.getElementById('landing-view').classList.remove('hidden');
      window.scrollTo(0, 0);

      // Update URL hash
      if (window.location.hash !== '') {
        history.pushState(null, '', window.location.pathname);
      }
    }

    // Handle initial load and hash changes
    function handleRoute() {
      if (window.location.hash === '#app') {
        showAppView();
      } else {
        showLandingView();
      }
    }

    // Listen for hash changes (browser back/forward)
    window.addEventListener('hashchange', handleRoute);

    // Handle initial page load
    window.addEventListener('DOMContentLoaded', handleRoute);

    // Navbar scroll effect
    window.addEventListener('scroll', () => {
      const navbar = document.getElementById('navbar');
      if (navbar && window.scrollY > 50) {
        navbar.classList.add('scrolled');
      } else if (navbar) {
        navbar.classList.remove('scrolled');
      }
    });

    // Smooth scroll for anchor links (except #app)
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        const href = this.getAttribute('href');
        if (href !== '#' && href !== '#app') {
          e.preventDefault();
          const target = document.querySelector(href);
          if (target) {
            target.scrollIntoView({ behavior: 'smooth' });
          }
        }
      });
    });

    // Dev Console toggle
    function toggleDevConsole() {
      const devConsole = document.getElementById('devConsole');
      devConsole.classList.toggle('open');
    }

    // Update log count (called from Logger module)
    window.updateLogCount = function(count) {
      const countEl = document.getElementById('logCount');
      if (countEl) {
        countEl.textContent = count > 99 ? '99+' : count;
        countEl.classList.toggle('has-logs', count > 0);
      }
    };
  </script>

  <!-- App Script -->
  <script type="module" src="js/app.js"></script>
</body>
</html>
